<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lightweight Design Patterns in iOS (Part 1) - Observer</title>
    <link rel="stylesheet" href="/css/bulma.min.css">
    <link rel="stylesheet" href="/css/custom.css">
</head>

<body>
<nav class="navbar">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            Home
        </a>

        <div class="navbar-item">
            <a class="button is-link" href="/about">
                <strong>About me</strong>
            </a>
        </div>
    </div>
</nav>

<section class="section">
    <div class="container is-max-desktop">
        <div class="content">
            <p class="title is-spaced">Lightweight Design Patterns in iOS (Part 1) - Observer</p>
            
            
            <div class="box">
                <p class="subtitle">Table of Contents</p>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#observer-pattern">Observer Pattern</a></li>
    <li><a href="#define-an-observable">Define an Observable</a></li>
    <li><a href="#subscribe-to-a-request">Subscribe to a Request</a></li>
    <li><a href="#dispose-of-an-observer">Dispose of an Observer</a></li>
  </ul>
</nav>
            </div>
            
            
        </div>
    </div>
    <div class="container is-max-desktop mt-6">
        <div class="content has-text-justified-tablet">
            <p><strong>Design Patterns</strong> are part of Mobile Development for a while now and a revolution towards <em>Quality Assurance</em> is on. Such patterns have become a standard among the community, yet implementing an <em>academic</em> one might come with a price â€” <em>complexity</em>.</p>
<p>Because some <strong>Design Patterns</strong> solve very complex problems, they often result in a complicated implementation as well. So complex sometimes, that we tend to use heavy <strong>Third Party Frameworks</strong>, even for simple use cases.</p>
<blockquote>
<p>The time has come to combine quality and simplicity.</p>
</blockquote>
<p>ğŸ¬ Hi there, Iâ€™m Jean!</p>
<p>In this series, we are going to implement <em>4 of the most popular</em> <strong>Design Patterns</strong> in a lightweight manner.<br>
Todayâ€™s pattern is going to beâ€¦<br>
ğŸ¥<br>
â€¦the <strong>Observer Pattern</strong>! ğŸŠ</p>
<h2 id="observer-pattern">Observer Pattern</h2>
<hr>
<p>The Observation concept is getting more and more popular, mostly thanks to <em>ReactiveX (Rx)</em>. ğŸ‘€<br>
Now, if all you need is <strong>subscribing</strong> to network calls while having a <strong>functional programming</strong> style, without the need for <strong>Coroutines</strong>, maybe importing the Rx library isnâ€™t the best optionâ€¦ ğŸ¤”<br>
But guess what: you can do it yourself, with no more than ğŸ’¯ <strong>lines</strong>! ğŸ‘<br>
(see for yourself <a href="https://github.com/jhandguy/SwiftKotlination/blob/master/ios/Modules/NetworkKit/NetworkKit/Sources/Model/Network/NetworkManager.swift">here</a>) ğŸ˜œ</p>
<p>So! Shall we?! ğŸ§</p>
<h2 id="define-an-observable">Define an Observable</h2>
<hr>
<p>To start, letâ€™s create a <em>Result</em> enum.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">enum</span> <span style="color:#5dd8ff">Result</span>&lt;T&gt; {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">case</span> success(T)
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">case</span> failure(Error)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Then, letâ€™s define the <em>Observer</em> type alias, which is no more than a <strong>closure</strong> taking a <em>Result</em> as parameter.</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">typealias</span> Observer&lt;T&gt; = (Result&lt;T&gt;) -&gt; <span style="color:#d0a8ff">Void</span>
</span></span></code></pre></div><p>Simple so far, right? Moving on! ğŸƒâ€</p>
<p>The next element we need is the <em>Request</em> enum for the <em>NetworkManager</em>.<br>
It needs to contain a <em>url</em>, a <em>method</em> as well as <em>parameters</em>. âœ…</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">enum</span> <span style="color:#5dd8ff">Request</span>: <span style="color:#d0a8ff">Hashable</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">case</span> fetchSomething
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">url</span>: <span style="color:#d0a8ff">String</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">switch</span> <span style="color:#fc5fa3">self</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">case</span> .fetchSomething:
</span></span><span style="display:flex;"><span>         <span style="color:#fc5fa3">return</span> <span style="color:#fc6a5d">&#34;https://api.com/something&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">method</span>: HTTPMethod {
</span></span><span style="display:flex;"><span>        <span style="color:#fc5fa3">switch</span> <span style="color:#fc5fa3">self</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fc5fa3">case</span> .fetchSomething
</span></span><span style="display:flex;"><span>            <span style="color:#fc5fa3">return</span> .<span style="color:#fc5fa3">get</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">parameters</span>: Parameters {
</span></span><span style="display:flex;"><span>       <span style="color:#fc5fa3">switch</span> <span style="color:#fc5fa3">self</span> {
</span></span><span style="display:flex;"><span>       <span style="color:#fc5fa3">case</span> .fetchSomething:
</span></span><span style="display:flex;"><span>          <span style="color:#fc5fa3">return</span> .url([<span style="color:#fc6a5d">&#34;api-key&#34;</span>: <span style="color:#fc6a5d">&#34;abcd1234&#34;</span>])
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Yaaaaaay, a fancy enum as we all love it! ğŸ‰</p>
<p>But have you noticed? The enum <em>Request</em> is <em>Hashable</em>! ğŸ¤­<br>
This means that a <em>Request</em> can be used as key to a Dictionaryâ€¦ ğŸ¤”<br>
In this case, <strong>subscribe</strong> to a <em>Request</em> means that the <em>Observer(s)</em> will need to be grouped by <em>Request</em>. Which leads us to a Dictionary with <em>Requests</em> as <strong>keys</strong> and <em>Observers</em> as <strong>values</strong>: we are of course talking about the <strong>observables</strong>! ğŸ¤¯</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">observables</span>: [Request: [Observer&lt;Data&gt;]]
</span></span></code></pre></div><p>Looking good huh?! ğŸ˜<br>
â€œOnly one thing missingâ€- youâ€™ll tell me - â€œhow do we subscribe to them?â€ ğŸ¤”</p>
<h2 id="subscribe-to-a-request">Subscribe to a Request</h2>
<hr>
<p>Looking now at the <em>NetworkManager</em>, its protocol is quite synthetic:<br>
<strong>observe</strong> a <em>Request</em> with an <em>Observer</em> or simply <strong>execute</strong> a <em>Request</em>. ğŸ‘Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">protocol</span> <span style="color:#5dd8ff">NetworkManagerProtocol</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">observe</span>(<span style="color:#fc5fa3">_</span> request: Request, <span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Data&gt;)
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">execute</span>(<span style="color:#fc5fa3">_</span> request: Request)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Nice and simple, all we want, is <strong>observe</strong> a <em>Request</em>, with a given <em>Observer</em> and in case of a pull-to-refresh action, simply <strong>executes</strong> a <em>Request</em> to notify the <strong>subscribed</strong> <em>Observer(s)</em>! ğŸš€</p>
<p>Alright, letâ€™s implement it then! ğŸ’ª</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">extension</span> <span style="color:#5dd8ff">NetworkManager</span>: NetworkManagerProtocol {
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">observe</span>(<span style="color:#fc5fa3">_</span> request: Request, <span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Data&gt;) {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">observers</span> = observables[request] ?? []
</span></span><span style="display:flex;"><span>      observers.append(observer)
</span></span><span style="display:flex;"><span>      observables[request] = observers
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      execute(request, with: [observer])
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">execute</span>(<span style="color:#fc5fa3">_</span> request: Request) {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">guard</span> <span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">observers</span> = observables[request] <span style="color:#fc5fa3">else</span> {
</span></span><span style="display:flex;"><span>         <span style="color:#fc5fa3">return</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      execute(request, with: observers)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And thatâ€™s it! Weâ€™re done! âœ…<br>
We now can <strong>decode</strong> Data to <em>Something</em> in a dedicated <em>Manager</em>! ğŸ‘Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">something</span>(<span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Something&gt;) {
</span></span><span style="display:flex;"><span>   networkManager
</span></span><span style="display:flex;"><span>      .observe(.fetchSomething) { result <span style="color:#fc5fa3">in</span>
</span></span><span style="display:flex;"><span>         ...
</span></span><span style="display:flex;"><span>   }   
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And use this <em>Manager</em> in the <em>ViewController</em> to update the view accordingly! ğŸ‘</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">override</span> <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">viewWillAppear</span>(<span style="color:#fc5fa3">_</span> animated: <span style="color:#d0a8ff">Bool</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">super</span>.viewWillAppear(animated)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   somethingManager
</span></span><span style="display:flex;"><span>      .something { [<span style="color:#fc5fa3">weak</span> <span style="color:#fc5fa3">self</span>] result <span style="color:#fc5fa3">in</span>
</span></span><span style="display:flex;"><span>         ...
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Looks good! ğŸ˜<br>
We got something pretty much looking like RxSwift there! ğŸ™Œ<br>
Now, donâ€™t you see anything wrong in what weâ€™ve done so far?<br>
Have you ever encountered something called <strong>DisposeBag</strong> in Rx?<br>
Thatâ€™s right, with the way we implemented the <strong>Observer</strong> pattern, we might have memory leaks! ğŸ˜±</p>
<p>Iâ€™m sure you know where Iâ€™m going, donâ€™t yaâ€™? ğŸ˜›<br>
Letâ€™s implement a <strong>DisposeBag</strong> ourselves then! ğŸ’ª</p>
<h2 id="dispose-of-an-observer">Dispose of an Observer</h2>
<hr>
<p>So, to dispose of an <em>Observer</em>, we first need to identify it, as so far it is simply stored in an array, remember? ğŸ™‚</p>
<p>How about having a Dictionary instead with <strong>unique identifiers</strong> as keys?! ğŸ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">observables</span>: [Request: [UUID: Observer&lt;Data&gt;]]
</span></span></code></pre></div><p>Nice!<br>
Now, an <strong>observable</strong> consists of a <em>Request</em>, which is <strong>observed</strong> by one or several <em>Observer(s)</em>.<br>
Each one of them, is uniquely <strong>identified</strong> with a <em>UUID</em>! ğŸ‘</p>
<p>Awesome, letâ€™s change the <em>NetworkManager</em> a little bitâ€¦ ğŸ˜•</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">extension</span> <span style="color:#5dd8ff">NetworkManager</span>: NetworkManagerProtocol {
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">observe</span>(<span style="color:#fc5fa3">_</span> request: Request, <span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Data&gt;) {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">uuid</span> = UUID()
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">observers</span> = observables[request] ?? [:]
</span></span><span style="display:flex;"><span>      observers[uuid] = observer
</span></span><span style="display:flex;"><span>      observables[request] = observers
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      execute(request, with: [observer])
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">execute</span>(<span style="color:#fc5fa3">_</span> request: Request) {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">guard</span> <span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">observers</span> = observables[request] <span style="color:#fc5fa3">else</span> {
</span></span><span style="display:flex;"><span>         <span style="color:#fc5fa3">return</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      execute(request, with: observers.<span style="color:#a167e6">map</span> { <span style="color:#41a1c0">$0</span>.value })
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Not so bad finally, it looks almost the same! ğŸ˜²<br>
Alright, last piece of the puzzle, I promise! ğŸ˜‡</p>
<p>We need to implement a Disposable, so we can <strong>dispose</strong> of an <em>Observer</em>. ğŸ—‘</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">struct</span> <span style="color:#5dd8ff">Disposable</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">closure</span>: () -&gt; <span style="color:#d0a8ff">Void</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, letâ€™s make the <em>DisposeBag</em>! ğŸ‘œ</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">final</span> <span style="color:#fc5fa3">class</span> <span style="color:#5dd8ff">DisposeBag</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">disposables</span>: [Disposable] = []
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">dispose</span>() {
</span></span><span style="display:flex;"><span>      disposables.forEach { <span style="color:#41a1c0">$0</span>.closure() }
</span></span><span style="display:flex;"><span>      disposables = []
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Finally, letâ€™s bind those two together! ğŸ’</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">extension</span> <span style="color:#5dd8ff">Disposable</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">disposed</span>(by disposeBag: DisposeBag) {
</span></span><span style="display:flex;"><span>      disposeBag.disposables.append(<span style="color:#fc5fa3">self</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>That was easy! ğŸ˜<br>
Almost there, only one last small tweak in the <em>NetworkManager</em> and weâ€™re finished! ğŸ<br>
Letâ€™s now return the <em>Disposable</em> when <strong>observing</strong> a <em>Request</em>!</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">protocol</span> <span style="color:#5dd8ff">NetworkManagerProtocol</span> {
</span></span><span style="display:flex;"><span>   @discardableResult
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">observe</span>(<span style="color:#fc5fa3">_</span> request: Request, <span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Data&gt;) -&gt; Disposable
</span></span><span style="display:flex;"><span>   ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">extension</span> <span style="color:#5dd8ff">NetworkManager</span>: NetworkManagerProtocol {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   @discardableResult
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">observe</span>(<span style="color:#fc5fa3">_</span> request: Request, <span style="color:#fc5fa3">_</span> observer: @escaping Observer&lt;Data&gt;) {
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">uuid</span> = UUID()
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">var</span> <span style="color:#41a1c0">observers</span> = observables[request] ?? [:]
</span></span><span style="display:flex;"><span>      observers[uuid] = observer
</span></span><span style="display:flex;"><span>      observables[request] = observers
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      execute(request, with: [observer])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      <span style="color:#fc5fa3">return</span> Disposable { [<span style="color:#fc5fa3">weak</span> <span style="color:#fc5fa3">self</span>] <span style="color:#fc5fa3">in</span>
</span></span><span style="display:flex;"><span>         <span style="color:#fc5fa3">self</span>?.observables[request]?.removeValue(forKey: uuid)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And weâ€™re finally done! ğŸ™Œ</p>
<p>From now on, <strong>disposing</strong> an <strong>observable</strong> from the <em>ViewController</em> is ridiculously simple! ğŸ˜†</p>
<div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#fc5fa3">let</span> <span style="color:#41a1c0">disposeBag</span> = DisposeBag()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fc5fa3">override</span> <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">viewWillAppear</span>(<span style="color:#fc5fa3">_</span> animated: <span style="color:#d0a8ff">Bool</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">super</span>.viewWillAppear(animated)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   somethingManager
</span></span><span style="display:flex;"><span>      .something { [<span style="color:#fc5fa3">weak</span> <span style="color:#fc5fa3">self</span>] result <span style="color:#fc5fa3">in</span>
</span></span><span style="display:flex;"><span>         ...
</span></span><span style="display:flex;"><span>   }.disposed(by: disposeBag)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fc5fa3">override</span> <span style="color:#fc5fa3">func</span> <span style="color:#41a1c0">viewWillDisappear</span>(<span style="color:#fc5fa3">_</span> animated: <span style="color:#d0a8ff">Bool</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#fc5fa3">super</span>.viewWillDisappear(animated)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>   disposeBag.dispose()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And boom! ğŸ’¥<br>
We just made our own lightweight RxSwift-like <strong>Observer Pattern</strong>, without importing a single Framework! ğŸ“¦</p>
<p>Was it worth it? Did that help you understand what problems the <strong>Observer Pattern</strong> is trying to solve?</p>
<p>If so, follow me on <a href="https://twitter.com/jhandguy">Twitter</a>, Iâ€™ll be happy to answer any of your questions and youâ€™ll be the first one to know when a new article comes out! ğŸ‘Œ</p>
<p>See you next week, for the Part 2 of my series <strong>Lightweight Design Patterns in iOS</strong>!</p>
<p>Bye bye! ğŸ‘‹</p>

        </div>
    </div>
</section>

</body>
<footer>
    <div class="footer pt-3 has-background-black-bis">
        <div class="container pb-6 has-text-centered is-mobile columns">
            <div class="column is-narrow paddingless">
                
                
                <a class="button is-large" disabled><strong>ğŸ‘ˆ</strong></a>
                
                
            </div>
            <div class="column"></div>
            <div class="column is-narrow paddingless">
                <a class="button is-large" href="#"><strong>ğŸ‘†</strong></a>
            </div>
            <div class="column"></div>
            <div class="column is-narrow paddingless">
                
                
                <a class="button is-large" href="https://jhandguy.github.io/posts/presenter-design-pattern-ios/"><strong>ğŸ‘‰</strong></a>
                
                
            </div>
        </div>
        <div class="content has-text-centered">
            <p class="subtitle is-6">Powered by <a href="https://gohugo.io/">Hugo</a></p>
            <a href="https://bulma.io">
                <img src="/images/footer/made-with-bulma.png" alt="Made with Bulma" width="128" height="24">
            </a>
        </div>
    </div>
</footer>

</html>
